<% include ../partials/header.ejs %>
<% include ../partials/main_nav.ejs %>

<script>
  function handleDelete(recipiesid) {
    if (confirm('are you sure you want to delete this recipie')) {
      fetch(/recipielist/delete/${recipiesid}, {
        method: 'DELETE',
        headers: {
          'Content-Type': 'application/json'
        }
      })
      .then(response => {
        if (response.ok) {
          location.reload(); // Refresh the page after successful deletion
        } else {
          throw new Error('Something went wrong while deleting');
        }
      })
      .catch(error => {
        console.error('Error:', error);
        // Handle error or show a message to the user
      });
    }
  }
</script>

<main class="container">
    <div class="row">
        <div class="offset-md-1 col-md-10">
            <h1><% title %> </h1>        

            <a href ="/recipielist/add" class = "btn btn-primary" role=button> 
            <i class = "fas fa-plus-circle"> </i> Add a Recipie
            </a> 
            <br> 
        
        <br>
        <table class="table table-bordered table-striped table-hover">
            <tr class="d-flex">
                <th class="text-center col-1">Name</th>
                <th class="text-center col-3">Ingridients</th>
                <th class="text-center col-3">Description</th>
                <th class="text-center col-3">Instructions</th>
                <th class="text-center col-1">Duration</th>
                <th class="text-center col-1"></th>
                <th class="text-center col-1"></th>
            </tr>
            <% for(let count=0;count<recipielist.length;count++) { %>    
            <tr class="d-flex">
                <td class="text-center col-1"><%= recipielist[count].name%></td>
                <td class="text-center col-3"><%= recipielist[count].ingridients%></td>
                <td class="text-center col-3"><%= recipielist[count].description %></td>
                <td class="text-center col-3"><%= recipielist[count].instructions%></td>
                <td class="text-center col-1"><%= recipielist[count].duration%></td>
                 <td class="text-center col-1">
                 <a href="/recipielist/edit/<%= recipielist[count]._id %>"
                 class= "btn btn-primary">
                 <i class="fa-solid fa-pencil"></i> Edit </a> 
                 </td>

                <td class="text-center col-1">
                 <a href="/recipielist/delete/<%= recipielist[count]._id %>"
                 class= "btn btn-danger">
                 <i class="fa-solid fa-trash"></i> Delete </a> 
                 </td>
               
            <% } %>
        </table>
    </div>
    </div>
</main>
<% include ../partials/bottom_navigation.ejs %>
<% include ../partials/footer.ejs %>